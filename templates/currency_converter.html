<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Currency Converter</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <style>
    body {
      background: linear-gradient(135deg, #f8f9fa, #ffffff);
      color: #212529;
      font-family: 'Segoe UI', sans-serif;
    }
    .navbar {
      background-color: rgb(18, 15, 206) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .navbar-brand, .nav-link {
      color: #ffffff !important;
    }
    .navbar-brand i, .nav-link i {
      margin-right: 5px;
    }
    .card {
      background-color: #ffffff;
      border: 1px solid #dee2e6;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .card-header {
      background: linear-gradient(to right, rgb(18, 15, 206), rgb(92, 71, 228));
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
      color: white;
    }
    .form-label, .form-select, .form-control {
      background-color: #ffffff;
      border: 1px solid #ced4da;
      color: #212529;
    }
    .form-select:focus, .form-control:focus {
      border-color: rgb(18, 15, 206);
      box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    }
    .btn-primary {
      background-color: rgb(18, 15, 206);
      border: none;
      box-shadow: 0 4px 12px rgba(0, 123, 255, 0.2);
    }
    .btn-info {
      background-color: rgb(23, 23, 184);
      border: none;
      color: #fff;
      box-shadow: 0 4px 12px rgba(23, 162, 184, 0.3);
    }
    .result-display {
      background-color: #e9f7fe;
      color: rgb(18, 15, 207);
      border: 2px dashed #66b2ff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 123, 255, 0.1);
    }
    .result-display h2 {
      color: #28a745;
      font-weight: bold;
    }
    footer {
      background-color: #f8f9fa;
      color: #6c757d;
      padding: 20px 0;
      text-align: center;
      box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
      margin-top: 50px;
    }
  </style>
</head>
<body>

  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><i class="fas fa-exchange-alt"></i> Currency Converter</a>
    </div>
  </nav>

  

  <!-- Main Content -->
  <div class="container mt-5">
    <div class="card">
      <div class="card-header text-center">
        <h3>Convert Currency</h3>
        <small>Date: <span id="current-date"></span></small>
      </div>
      <div class="card-body">
        <form id="converter-form">
          <div class="mb-3">
            <label for="amount" class="form-label">Amount</label>
            <input type="number" class="form-control" id="amount" required>
          </div>

         <!-- From Currency Dropdown -->
<div class="mb-3">
  <label for="from_currency" class="form-label">From</label>
  <select class="form-select" id="from_currency" required>
    {% for currency in currencies %}
      <option value="{{ currency }}">{{ currency }}</option>
    {% endfor %}
  </select>
</div>

<!-- To Currency Dropdown -->
<div class="mb-3">
  <label for="to_currency" class="form-label">To</label>
  <select class="form-select" id="to_currency" required>
    {% for currency in currencies %}
      <option value="{{ currency }}">{{ currency }}</option>
    {% endfor %}
  </select>
</div>

          <div class="d-flex justify-content-between align-items-center">
            <button type="button" class="btn btn-info" id="swap-button"><i class="fas fa-exchange-alt"></i> Swap</button>
            <button type="submit" class="btn btn-primary">Convert</button>
          </div>
        </form>

        <div class="text-center mt-4">
  <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Return to Dashboard</a>

    
  </a>
</div>


        <!-- Result Display -->
        <div id="result-container" class="mt-4 result-display" style="display: none;">
          <h5>Conversion Result:</h5>
          <p><span id="result-amount"></span> <span id="result-from"></span> = 
          <strong id="result-value"></strong> <span id="result-to"></span></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2025 Currency Exchange Application. All rights reserved.</p>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Custom JS -->
 <!-- Replace the existing script section with this updated version -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Set current date
    const now = new Date();
    document.getElementById('current-date').textContent = now.toLocaleDateString();

    // Swap currencies
    document.getElementById('swap-button').addEventListener('click', function () {
        const fromSelect = document.getElementById('from_currency');
        const toSelect = document.getElementById('to_currency');
        const temp = fromSelect.value;
        fromSelect.value = toSelect.value;
        toSelect.value = temp;
    });

    // Handle form submission
    document.getElementById('converter-form').addEventListener('submit', function (e) {
        e.preventDefault();

        const amount = document.getElementById('amount').value;
        const fromCurrency = document.getElementById('from_currency').value;
        const toCurrency = document.getElementById('to_currency').value;

        // Validate input
        if (!amount || isNaN(amount) || parseFloat(amount) <= 0) {
            alert('Please enter a valid positive number for the amount');
            return;
        }

        if (!fromCurrency || !toCurrency) {
            alert('Please select both currencies');
            return;
        }

        const submitBtn = this.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Converting...';
        submitBtn.disabled = true;

        const resultContainer = document.getElementById('result-container');

        fetch('/convert', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({
                amount: amount,
                from_currency: fromCurrency,
                to_currency: toCurrency,
            }),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            submitBtn.innerHTML = originalBtnText;
            submitBtn.disabled = false;

            if (data.success) {
                document.getElementById('result-amount').textContent = parseFloat(amount).toLocaleString();
                document.getElementById('result-from').textContent = fromCurrency;
                document.getElementById('result-to').textContent = toCurrency;
                document.getElementById('result-value').textContent = parseFloat(data.converted_amount).toLocaleString();
                resultContainer.style.display = 'block';
                
                // Add rate information if available
                if (data.rate_used) {
                    const rateInfo = document.createElement('p');
                    rateInfo.className = 'text-muted';
                    rateInfo.textContent = `Exchange rate: 1 ${fromCurrency} = ${data.rate_used} ${toCurrency}`;
                    resultContainer.appendChild(rateInfo);
                }
            } else {
                alert(data.message || 'Conversion failed. Please try again.');
                resultContainer.style.display = 'none';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            submitBtn.innerHTML = originalBtnText;
            submitBtn.disabled = false;
            alert('An error occurred. Please try again.');
            resultContainer.style.display = 'none';
        });
    });
});
</script>

</body>
</html>
